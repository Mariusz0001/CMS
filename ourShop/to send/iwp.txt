CREATE TABLE public."MenuBook"
(
    "Id" integer NOT NULL GENERATED ALWAYS AS IDENTITY ( INCREMENT 1 START 1 MINVALUE 1 MAXVALUE 2147483647 CACHE 1 ),
    "ParentId" integer,
    "MenuText" character varying(200) COLLATE pg_catalog."default",
    "OrderNumber" integer,
    CONSTRAINT "MenuBook_pkey" PRIMARY KEY ("Id")
)

TABLESPACE pg_default;

ALTER TABLE public."MenuBook"
    OWNER to postgres;

GRANT SELECT ON TABLE public."MenuBook" TO ourshopuser;

GRANT ALL ON TABLE public."MenuBook" TO postgres;



CREATE TABLE public."MenuPermission"
(
    "IdPermissionBook" integer NOT NULL,
    "IdMenu" integer NOT NULL,
    CONSTRAINT "UniquePermission" UNIQUE ("IdPermissionBook", "IdMenu")
)

TABLESPACE pg_default;

ALTER TABLE public."MenuPermission"
    OWNER to postgres;

GRANT SELECT ON TABLE public."MenuPermission" TO ourshopuser;

GRANT ALL ON TABLE public."MenuPermission" TO postgres;





CREATE TABLE public."Log"
(
    "CreationDate" timestamp without time zone not NULL,
    "IdLogsType" integer,
    "IdUser" integer,
    "HostName" character varying(200) COLLATE pg_catalog."default",
    "Module" character varying(200) COLLATE pg_catalog."default",
	"Description" character varying(500) COLLATE pg_catalog."default"
)

TABLESPACE pg_default;

ALTER TABLE public."Log"
    OWNER to postgres;

GRANT INSERT, SELECT ON TABLE public."Log" TO ourshopuser;

GRANT ALL ON TABLE public."Log" TO postgres;



CREATE TABLE public."LogsType"
(
    "Id" integer NOT NULL GENERATED ALWAYS AS IDENTITY ( INCREMENT 1 START 1 MINVALUE 1 MAXVALUE 2147483647 CACHE 1 ),
    "Name" character varying(200) COLLATE pg_catalog."default",
    CONSTRAINT "LogsType_pkey" PRIMARY KEY ("Id")
)

TABLESPACE pg_default;

ALTER TABLE public."LogsType"
    OWNER to postgres;

GRANT SELECT ON TABLE public."LogsType" TO ourshopuser;

GRANT ALL ON TABLE public."LogsType" TO postgres;



INSERT INTO public."LogsType"(
	"Name")
	VALUES ('Error');
	
INSERT INTO public."LogsType"(
	"Name")
	VALUES ('Warning');
	
INSERT INTO public."LogsType"(
	"Name")
	VALUES ('Information');





CREATE OR REPLACE PROCEDURE public.add_log(
	_iduser integer DEFAULT NULL::integer,
	_idlogstype integer DEFAULT NULL::integer,
	_hostname character varying DEFAULT NULL::character varying,
	_module character varying DEFAULT NULL::character varying,
	_description character varying DEFAULT NULL::character varying)
LANGUAGE 'plpgsql'
AS $BODY$
DECLARE
BEGIN
	INSERT INTO public."Log"(
	"CreationDate", "IdLogsType", "IdUser", "HostName", "Module", "Description")
	VALUES (NOW(), _idlogstype, _iduser, _hostname, _module, _description);
END
$BODY$;

GRANT EXECUTE ON PROCEDURE public.add_log(integer, integer, character varying, character varying, character varying) TO postgres;

GRANT EXECUTE ON PROCEDURE public.add_log(integer, integer, character varying, character varying, character varying) TO PUBLIC;

GRANT EXECUTE ON PROCEDURE public.add_log(integer, integer, character varying, character varying, character varying) TO ourshopuser;

